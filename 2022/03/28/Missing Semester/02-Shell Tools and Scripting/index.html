<!DOCTYPE html><html lang="zh-CN" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no"><title>02 - Shell Tools and Scripting | Sicilienne</title><meta name="keywords" content="shell"><meta name="author" content="Zoris"><meta name="copyright" content="Zoris"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#ffffff"><meta name="description" content="Use shell">
<meta property="og:type" content="article">
<meta property="og:title" content="02 - Shell Tools and Scripting">
<meta property="og:url" content="http://example.com/2022/03/28/Missing%20Semester/02-Shell%20Tools%20and%20Scripting/index.html">
<meta property="og:site_name" content="Sicilienne">
<meta property="og:description" content="Use shell">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://raw.githubusercontent.com/Warmchay/img/main/%E6%88%AA%E5%B1%8F2022-03-27%20%E4%B8%8B%E5%8D%8810.00.17.png">
<meta property="article:published_time" content="2022-03-28T12:23:21.000Z">
<meta property="article:modified_time" content="2022-03-28T12:24:14.790Z">
<meta property="article:author" content="Zoris">
<meta property="article:tag" content="Tools">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://raw.githubusercontent.com/Warmchay/img/main/%E6%88%AA%E5%B1%8F2022-03-27%20%E4%B8%8B%E5%8D%8810.00.17.png"><link rel="shortcut icon" href="/img/favicon.png"><link rel="canonical" href="http://example.com/2022/03/28/Missing%20Semester/02-Shell%20Tools%20and%20Scripting/"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="preconnect" href="//busuanzi.ibruce.info"/><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6/css/all.min.css" media="print" onload="this.media='all'"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/ui/dist/fancybox.css" media="print" onload="this.media='all'"><script>const GLOBAL_CONFIG = { 
  root: '/',
  algolia: undefined,
  localSearch: undefined,
  translate: {"defaultEncoding":2,"translateDelay":0,"msgToTraditionalChinese":"简","msgToSimplifiedChinese":"繁"},
  noticeOutdate: undefined,
  highlight: {"plugin":"highlighjs","highlightCopy":true,"highlightLang":true,"highlightHeightLimit":false},
  copy: {
    success: '复制成功',
    error: '复制错误',
    noSupport: '浏览器不支持'
  },
  relativeDate: {
    homepage: false,
    post: false
  },
  runtime: '',
  date_suffix: {
    just: '刚刚',
    min: '分钟前',
    hour: '小时前',
    day: '天前',
    month: '个月前'
  },
  copyright: undefined,
  lightbox: 'fancybox',
  Snackbar: undefined,
  source: {
    justifiedGallery: {
      js: 'https://cdn.jsdelivr.net/npm/flickr-justified-gallery@2/dist/fjGallery.min.js',
      css: 'https://cdn.jsdelivr.net/npm/flickr-justified-gallery@2/dist/fjGallery.min.css'
    }
  },
  isPhotoFigcaption: false,
  islazyload: false,
  isAnchor: false
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE = {
  title: '02 - Shell Tools and Scripting',
  isPost: true,
  isHome: false,
  isHighlightShrink: false,
  isToc: true,
  postUpdate: '2022-03-28 20:24:14'
}</script><noscript><style type="text/css">
  #nav {
    opacity: 1
  }
  .justified-gallery img {
    opacity: 1
  }

  #recent-posts time,
  #post-meta time {
    display: inline !important
  }
</style></noscript><script>(win=>{
    win.saveToLocal = {
      set: function setWithExpiry(key, value, ttl) {
        if (ttl === 0) return
        const now = new Date()
        const expiryDay = ttl * 86400000
        const item = {
          value: value,
          expiry: now.getTime() + expiryDay,
        }
        localStorage.setItem(key, JSON.stringify(item))
      },

      get: function getWithExpiry(key) {
        const itemStr = localStorage.getItem(key)

        if (!itemStr) {
          return undefined
        }
        const item = JSON.parse(itemStr)
        const now = new Date()

        if (now.getTime() > item.expiry) {
          localStorage.removeItem(key)
          return undefined
        }
        return item.value
      }
    }
  
    win.getScript = url => new Promise((resolve, reject) => {
      const script = document.createElement('script')
      script.src = url
      script.async = true
      script.onerror = reject
      script.onload = script.onreadystatechange = function() {
        const loadState = this.readyState
        if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
        script.onload = script.onreadystatechange = null
        resolve()
      }
      document.head.appendChild(script)
    })
  
      win.activateDarkMode = function () {
        document.documentElement.setAttribute('data-theme', 'dark')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#0d0d0d')
        }
      }
      win.activateLightMode = function () {
        document.documentElement.setAttribute('data-theme', 'light')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#ffffff')
        }
      }
      const t = saveToLocal.get('theme')
    
          if (t === 'dark') activateDarkMode()
          else if (t === 'light') activateLightMode()
        
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined) {
        if (asideStatus === 'hide') {
          document.documentElement.classList.add('hide-aside')
        } else {
          document.documentElement.classList.remove('hide-aside')
        }
      }
    
    const detectApple = () => {
      if(/iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)){
        document.documentElement.classList.add('apple')
      }
    }
    detectApple()
    })(window)</script><meta name="generator" content="Hexo 6.1.0"></head><body><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="avatar-img is-center"><img src="https://raw.githubusercontent.com/Warmchay/img/main/1521647611449_.pic.jpg" onerror="onerror=null;src='/img/friend_404.gif'" alt="avatar"/></div><div class="sidebar-site-data site-data is-center"><a href="/archives/"><div class="headline">文章</div><div class="length-num">4</div></a><a href="/tags/"><div class="headline">标签</div><div class="length-num">2</div></a><a href="/categories/"><div class="headline">分类</div><div class="length-num">2</div></a></div><hr/><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 主页</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> 时间轴</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> 标签</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> 分类</span></a></div><div class="menus_item"><a class="site-page group" href="javascript:void(0);"><i class="fa-fw fas fa-list"></i><span> 清单</span><i class="fas fa-chevron-down"></i></a><ul class="menus_item_child"><li><a class="site-page child" href="/music/"><i class="fa-fw fas fa-music"></i><span> 音乐</span></a></li><li><a class="site-page child" href="/movies/"><i class="fa-fw fas fa-video"></i><span> 电影</span></a></li><li><a class="site-page child" href="/Gallery/"><i class="fa-fw fas fa-images"></i><span> 照片</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fas fa-link"></i><span> 友链</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-heart"></i><span> 关于</span></a></div></div></div></div><div class="post" id="body-wrap"><header class="post-bg" id="page-header" style="background-image: url('https://raw.githubusercontent.com/Warmchay/img/main/%E6%88%AA%E5%B1%8F2022-03-27%20%E4%B8%8B%E5%8D%8810.00.17.png')"><nav id="nav"><span id="blog_name"><a id="site-name" href="/">Sicilienne</a></span><div id="menus"><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 主页</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> 时间轴</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> 标签</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> 分类</span></a></div><div class="menus_item"><a class="site-page group" href="javascript:void(0);"><i class="fa-fw fas fa-list"></i><span> 清单</span><i class="fas fa-chevron-down"></i></a><ul class="menus_item_child"><li><a class="site-page child" href="/music/"><i class="fa-fw fas fa-music"></i><span> 音乐</span></a></li><li><a class="site-page child" href="/movies/"><i class="fa-fw fas fa-video"></i><span> 电影</span></a></li><li><a class="site-page child" href="/Gallery/"><i class="fa-fw fas fa-images"></i><span> 照片</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fas fa-link"></i><span> 友链</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-heart"></i><span> 关于</span></a></div></div><div id="toggle-menu"><a class="site-page"><i class="fas fa-bars fa-fw"></i></a></div></div></nav><div id="post-info"><h1 class="post-title">02 - Shell Tools and Scripting</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="far fa-calendar-alt fa-fw post-meta-icon"></i><span class="post-meta-label">发表于</span><time class="post-meta-date-created" datetime="2022-03-28T12:23:21.000Z" title="发表于 2022-03-28 20:23:21">2022-03-28</time><span class="post-meta-separator">|</span><i class="fas fa-history fa-fw post-meta-icon"></i><span class="post-meta-label">更新于</span><time class="post-meta-date-updated" datetime="2022-03-28T12:24:14.790Z" title="更新于 2022-03-28 20:24:14">2022-03-28</time></span><span class="post-meta-categories"><span class="post-meta-separator">|</span><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/categories/Missing-Semester/">Missing Semester</a></span></div><div class="meta-secondline"><span class="post-meta-separator">|</span><span class="post-meta-pv-cv" id="" data-flag-title="02 - Shell Tools and Scripting"><i class="far fa-eye fa-fw post-meta-icon"></i><span class="post-meta-label">阅读量:</span><span id="busuanzi_value_page_pv"></span></span></div></div></div></header><main class="layout" id="content-inner"><div id="post"><article class="post-content" id="article-container"><h1 id="Command-ls-args"><a href="#Command-ls-args" class="headerlink" title="Command: ls args"></a>Command: <code>ls args</code></h1><ol>
<li><strong>Read <a target="_blank" rel="noopener" href="https://www.man7.org/linux/man-pages/man1/ls.1.html"><code>man ls</code></a> and write an <code>ls</code> command that lists files in the following manner</strong></li>
</ol>
<ul>
<li><strong>Includes all files, including hidden files</strong></li>
<li><strong>Sizes are listed in human readable format (e.g. 454M instead of 454279954)</strong></li>
<li><strong>Files are ordered by recency (时效性)</strong></li>
<li><strong>Output is colorized</strong></li>
</ul>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">$ <span class="built_in">ls</span> -ahltc</span><br><span class="line">-rw-r--r--   1 user group 1.1M Jan 14 09:53 baz</span><br><span class="line">drwxr-xr-x   5 user group  160 Jan 14 09:53 .</span><br><span class="line">-rw-r--r--   1 user group  514 Jan 14 06:42 bar</span><br><span class="line">-rw-r--r--   1 user group 106M Jan 13 12:12 foo</span><br><span class="line">drwx------+ 47 user group 1.5K Jan 12 18:08 ..</span><br></pre></td></tr></table></figure>

<blockquote>
<p><code>-h:</code> use unit suffixes: B, KB, MB…</p>
<p><code>-l:</code> list files in long format</p>
<p><code>-t:</code> sorted by descending time modified</p>
<p><code>-c:</code> use time when file status was last changed for sorting or printing.</p>
<p>In order to show <code>.</code> and <code>..</code> :</p>
<p><code>-a:</code> include dir entries whose names begin with a dot (<code>&#39;.&#39;</code>)</p>
</blockquote>
<h1 id="Bash-functions"><a href="#Bash-functions" class="headerlink" title="Bash functions"></a>Bash functions</h1><ol start="2">
<li><strong>Write bash functions <code>marco</code> and <code>polo</code> that do the following. Whenever you execute <code>marco</code> the current working directory should be saved in some manner, then when you execute <code>polo</code>, no matter what directory you are in, <code>polo</code> should <code>cd</code> you back to the directory where you executed <code>marco</code>. For ease of debugging you can write the code in a file <code>marco.sh</code> and (re)load the definitions to your shell by executing <code>source marco.sh</code>.</strong></li>
</ol>
<p>The whole processing is:</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">(base) zoriswangdeMacBook-Pro:xv6Core zoriswang$ vim marco.sh</span><br><span class="line">(base) zoriswangdeMacBook-Pro:xv6Core zoriswang$ <span class="built_in">source</span> marco.sh </span><br><span class="line">(base) zoriswangdeMacBook-Pro:xv6Core zoriswang$ marco <span class="built_in">test</span></span><br><span class="line">In /Users/zoriswang/Desktop/GitHub/xv6Core/test</span><br><span class="line">(base) zoriswangdeMacBook-Pro:<span class="built_in">test</span> zoriswang$ vim polo.sh</span><br><span class="line">(base) zoriswangdeMacBook-Pro:<span class="built_in">test</span> zoriswang$ <span class="built_in">source</span> polo.sh</span><br><span class="line">(base) zoriswangdeMacBook-Pro:<span class="built_in">test</span> zoriswang$ polo</span><br><span class="line">By using polo, now we are <span class="keyword">in</span> /Users/zoriswang/Desktop/GitHub/xv6Core</span><br></pre></td></tr></table></figure>

<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">// For simplify back to historical <span class="built_in">command</span>, use `<span class="built_in">history</span>` or Ctrl+R to check former <span class="built_in">command</span>.</span><br><span class="line">$ <span class="built_in">history</span> 1 | grep vim</span><br><span class="line">  120  vim test.cpp</span><br><span class="line">  126  vim test.cpp</span><br><span class="line">  128  vim test.cpp</span><br><span class="line">  130  vim test.cpp</span><br><span class="line">  166  vim ~/.bash_profile</span><br><span class="line">  402  vim semester </span><br><span class="line">  448  <span class="built_in">cd</span> <span class="built_in">test</span> &amp;&amp; vim mcd.sh</span><br><span class="line">  515  vim marco.sh</span><br><span class="line">  518  vim polo.sh</span><br></pre></td></tr></table></figure>

<p>But I find a nice shell named <a target="_blank" rel="noopener" href="https://fishshell.com/docs/current/tutorial.html">fish</a> , by using this, you could find your files more quickly. Such as following shortcutting:</p>
<img src="https://raw.githubusercontent.com/Warmchay/img/main/%E6%88%AA%E5%B1%8F2022-03-28%20%E4%B8%8B%E5%8D%884.35.20.png" style="zoom:50%;" />

<p>The <code>marco.sh</code> and <code>polo.sh</code> are:</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">// marco.sh</span><br><span class="line"><span class="function"><span class="title">marco</span></span> () &#123;</span><br><span class="line">  <span class="built_in">mkdir</span> <span class="string">&quot;<span class="variable">$1</span>&quot;</span></span><br><span class="line">  <span class="built_in">cd</span> <span class="string">&quot;<span class="variable">$1</span>&quot;</span></span><br><span class="line">  <span class="built_in">echo</span> <span class="string">&quot;In <span class="subst">$(pwd)</span>&quot;</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">// polo.sh</span><br><span class="line"><span class="function"><span class="title">polo</span></span> () &#123;</span><br><span class="line">  <span class="built_in">cd</span> ..</span><br><span class="line">  <span class="built_in">echo</span> <span class="string">&quot;By using polo, now we are in <span class="subst">$(pwd)</span>&quot;</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h1 id="BASH-Redirection"><a href="#BASH-Redirection" class="headerlink" title="BASH Redirection"></a>BASH Redirection</h1><ol start="3">
<li><p><strong>Say you have a command that fails rarely. In order to debug it you need to capture its output but it can be time consuming to get a failure run. Write a bash script that runs the following script until it fails and captures its standard output and error streams to files and prints everything at the end. Bonus points if you can also report how many runs it took for the script to fail.</strong></p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#!/usr/bin/env bash</span></span><br><span class="line">   </span><br><span class="line">n=$(( RANDOM % <span class="number">100</span> ))</span><br><span class="line">   </span><br><span class="line"><span class="keyword">if</span> [[ n -eq 42 ]]; <span class="keyword">then</span></span><br><span class="line">   <span class="built_in">echo</span> <span class="string">&quot;Something went wrong&quot;</span></span><br><span class="line">   &gt;&amp;2 <span class="built_in">echo</span> <span class="string">&quot;The error was using magic numbers&quot;</span></span><br><span class="line">   <span class="built_in">exit</span> 1</span><br><span class="line"><span class="keyword">fi</span></span><br><span class="line">   </span><br><span class="line"><span class="built_in">echo</span> <span class="string">&quot;Everything went according to plan&quot;</span></span><br></pre></td></tr></table></figure></li>
</ol>
<p>Let’s firstly check a demo code: (because I don’t understand <code>grep</code> that line’s function)</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#!/bin/bash</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">echo</span> <span class="string">&quot;Starting program at <span class="subst">$(date)</span>&quot;</span> <span class="comment"># Date will be substituted</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">echo</span> <span class="string">&quot;Running program <span class="variable">$0</span> with <span class="variable">$#</span> arguments with pid $$&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> file <span class="keyword">in</span> <span class="string">&quot;<span class="variable">$@</span>&quot;</span>; <span class="keyword">do</span></span><br><span class="line">    grep foobar <span class="string">&quot;<span class="variable">$file</span>&quot;</span> 1&gt; /dev/null 2&gt; /dev/null</span><br><span class="line">    <span class="comment"># When pattern is not found, grep has exit status 1</span></span><br><span class="line">    <span class="comment"># We redirect STDOUT and STDERR to a null register since we do not care about them</span></span><br><span class="line">    <span class="keyword">if</span> [[ $? -ne 0 ]]; <span class="keyword">then</span></span><br><span class="line">        <span class="built_in">echo</span> <span class="string">&quot;File <span class="variable">$file</span> does not have any foobar, adding one&quot;</span></span><br><span class="line">        <span class="built_in">echo</span> <span class="string">&quot;# foobar&quot;</span> &gt;&gt; <span class="string">&quot;<span class="variable">$file</span>&quot;</span></span><br><span class="line">    <span class="keyword">fi</span></span><br><span class="line"><span class="keyword">done</span></span><br></pre></td></tr></table></figure>

<blockquote>
<p><code>&gt; /dev/null 2&gt; /dev/null:</code> 将 grep 命令的 STDOUT(<code>1&gt;</code>) 和 STDERR(<code>2&gt;</code>) 都 redirect 到 <code>/dev/null</code> 设备上，表示舍弃。</p>
<p><code>/dev/null</code> 是特殊的 Linux 虚拟设备，专门用于倾倒不需要的垃圾数据 </p>
</blockquote>
<p>I find a stupid thing about my code: I always think the scripts only could be run after source and should allocate a specified function to it.</p>
<p>But it could run by add shebang <code>#!/usr/bin/env bash</code> , then use <code>bash xxx.sh</code> to run it is fine…</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">// use_random.sh</span><br><span class="line"><span class="comment">#!/usr/bin/env bash</span></span><br><span class="line"></span><br><span class="line">cnt=0</span><br><span class="line">err=0</span><br><span class="line"><span class="keyword">while</span> [ <span class="literal">true</span> ]; <span class="keyword">do</span></span><br><span class="line">  bash random.sh 1&gt;&gt;./mid-out.txt 2&gt;&gt;./mid-err.txt</span><br><span class="line">  ((++cnt))</span><br><span class="line">  <span class="keyword">if</span> [ -s ./mid-err.txt ]; <span class="keyword">then</span></span><br><span class="line">    <span class="built_in">break</span></span><br><span class="line">  <span class="keyword">fi</span></span><br><span class="line"><span class="keyword">done</span></span><br><span class="line"><span class="built_in">cat</span> ./mid-out.txt ./mid-err.txt</span><br><span class="line"><span class="built_in">rm</span> ./mid-out.txt ./mid-err.txt</span><br><span class="line"><span class="built_in">echo</span> <span class="string">&quot;runs <span class="variable">$cnt</span> times to throw an error&quot;</span></span><br></pre></td></tr></table></figure>

<img src="https://raw.githubusercontent.com/Warmchay/img/main/%E6%88%AA%E5%B1%8F2022-03-28%20%E4%B8%8B%E5%8D%885.45.22.png" style="zoom:67%;" />



<h1 id="find-amp-xargs"><a href="#find-amp-xargs" class="headerlink" title="find &amp; xargs"></a>find &amp; xargs</h1><ol start="4">
<li><strong>Write a command that recursively finds all HTML files in the folder and makes a zip with them. Note that your command should work even if the files have spaces (hint: check <code>-d</code> flag for <code>xargs</code>).</strong></li>
</ol>
<p>See some <code>xargs</code> examples by <code>tldr xargs</code>:</p>
<img src="https://raw.githubusercontent.com/Warmchay/img/main/%E6%88%AA%E5%B1%8F2022-03-28%20%E4%B8%8B%E5%8D%885.53.02.png" style="zoom:67%;" />

<p>So we could use <code>find</code> to get all html files as <code>xargs</code> arguments, then executes <code>tar</code> to zip thest input files.</p>
<p>What’s more, let’s check <code>tar</code> usage:</p>
<img src="https://raw.githubusercontent.com/Warmchay/img/main/%E6%88%AA%E5%B1%8F2022-03-28%20%E4%B8%8B%E5%8D%885.56.31.png" style="zoom:67%;" />

<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">// use this cmd</span><br><span class="line">$ find ~ -name <span class="string">&quot;*.html&quot;</span> | xargs tar cf 4.tar  </span><br></pre></td></tr></table></figure>

<p>List inner files in 4.tar:</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">$ tar tvf 4.tar</span><br><span class="line">-rw-r--r--  0 zoriswang staff     329 11 22 15:28 Users/zoriswang/.gitbook/versions/3.2.3/node_modules/npm/html/dochead.html</span><br><span class="line">.........</span><br><span class="line">-rw-r--r--  0 zoriswang staff     961 11 22 15:28 Users/zoriswang/.gitbook/versions/3.2.3/docs/_layouts/website/page.html</span><br></pre></td></tr></table></figure>

<p>Then <code>rm</code> them:</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">$ find 4.tar | xargs <span class="built_in">rm</span></span><br><span class="line">$ find 4.tar</span><br><span class="line">find: 4.tar: No such file or directory</span><br></pre></td></tr></table></figure>



<h1 id="Use-scripts-to-list-recently-files"><a href="#Use-scripts-to-list-recently-files" class="headerlink" title="Use scripts to list recently files"></a>Use scripts to list recently files</h1><ol start="5">
<li><strong>(Advanced) Write a command or script to recursively find the most recently modified file in a directory. More generally, can you list all files by recency?</strong></li>
</ol>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#!/usr/bin/env bash</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">echo</span> <span class="string">&quot;<span class="subst">$(ls -altc $1)</span>&quot;</span></span><br></pre></td></tr></table></figure>

<img src="https://raw.githubusercontent.com/Warmchay/img/main/%E6%88%AA%E5%B1%8F2022-03-28%20%E4%B8%8B%E5%8D%888.20.05.png" style="zoom:67%;" />

</article><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta">文章作者: </span><span class="post-copyright-info"><a href="http://example.com">Zoris</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta">文章链接: </span><span class="post-copyright-info"><a href="http://example.com/2022/03/28/Missing%20Semester/02-Shell%20Tools%20and%20Scripting/">http://example.com/2022/03/28/Missing%20Semester/02-Shell%20Tools%20and%20Scripting/</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta">版权声明: </span><span class="post-copyright-info">本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank">CC BY-NC-SA 4.0</a> 许可协议。转载请注明来自 <a href="http://example.com" target="_blank">Sicilienne</a>！</span></div></div><div class="tag_share"><div class="post-meta__tag-list"><a class="post-meta__tags" href="/tags/Tools/">Tools</a></div><div class="post_share"><div class="social-share" data-image="https://raw.githubusercontent.com/Warmchay/img/main/%E6%88%AA%E5%B1%8F2022-03-27%20%E4%B8%8B%E5%8D%8810.00.17.png" data-sites="facebook,twitter,wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/social-share.js/dist/css/share.min.css" media="print" onload="this.media='all'"><script src="https://cdn.jsdelivr.net/gh/overtrue/share.js@master/dist/js/social-share.min.js" defer></script></div></div><nav class="pagination-post" id="pagination"><div class="next-post pull-full"><a href="/2022/03/27/Advanced%20OS/02-Virtual%20Machine%20Monitor/"><img class="next-cover" src="https://raw.githubusercontent.com/Warmchay/img/main/%E6%88%AA%E5%B1%8F2022-03-27%20%E4%B8%8B%E5%8D%889.54.13.png" onerror="onerror=null;src='/img/404.jpg'" alt="cover of next post"><div class="pagination-info"><div class="label">下一篇</div><div class="next_info">02 - Virtual Machine Monitor</div></div></a></div></nav><div class="relatedPosts"><div class="headline"><i class="fas fa-thumbs-up fa-fw"></i><span>相关推荐</span></div><div class="relatedPosts-list"><div><a href="/2022/03/27/Missing%20Semester/01-Shell/" title="01 - Shell"><img class="cover" src="https://raw.githubusercontent.com/Warmchay/img/main/%E6%88%AA%E5%B1%8F2022-03-27%20%E4%B8%8B%E5%8D%8810.00.17.png" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2022-03-27</div><div class="title">01 - Shell</div></div></a></div></div></div><hr/><div id="post-comment"><div class="comment-head"><div class="comment-headline"><i class="fas fa-comments fa-fw"></i><span> 评论</span></div><div id="comment-switch"><span class="first-comment">Valine# Valine</span><span class="switch-btn"></span><span class="second-comment">Disqus</span></div></div><div class="comment-wrap"><div></div><div><div id="disqus_thread"></div></div></div></div></div><div class="aside-content" id="aside-content"><div class="card-widget card-info"><div class="is-center"><div class="avatar-img"><img src="https://raw.githubusercontent.com/Warmchay/img/main/1521647611449_.pic.jpg" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/></div><div class="author-info__name">Zoris</div><div class="author-info__description"></div></div><div class="card-info-data site-data is-center"><a href="/archives/"><div class="headline">文章</div><div class="length-num">4</div></a><a href="/tags/"><div class="headline">标签</div><div class="length-num">2</div></a><a href="/categories/"><div class="headline">分类</div><div class="length-num">2</div></a></div><a id="card-info-btn" target="_blank" rel="noopener" href="https://github.com/Warmchay"><i class="fab fa-github"></i><span>Follow Me</span></a><div class="card-info-social-icons is-center"><a class="social-icon" href="https://github.com/Warmchay" target="_blank" title="Github"><i class="fab fa-github"></i></a><a class="social-icon" href="mailto:zoriswang@gmail.com" target="_blank" title="Email"><i class="fas fa-envelope"></i></a></div></div><div class="card-widget card-announcement"><div class="item-headline"><i class="fas fa-bullhorn fa-shake"></i><span>公告</span></div><div class="announcement_content">Come to your senses, defense is not the way to go.</div></div><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><i class="fas fa-stream"></i><span>目录</span><span class="toc-percentage"></span></div><div class="toc-content"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#Command-ls-args"><span class="toc-number">1.</span> <span class="toc-text">Command: ls args</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#Bash-functions"><span class="toc-number">2.</span> <span class="toc-text">Bash functions</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#BASH-Redirection"><span class="toc-number">3.</span> <span class="toc-text">BASH Redirection</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#find-amp-xargs"><span class="toc-number">4.</span> <span class="toc-text">find &amp; xargs</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#Use-scripts-to-list-recently-files"><span class="toc-number">5.</span> <span class="toc-text">Use scripts to list recently files</span></a></li></ol></div></div><div class="card-widget card-recent-post"><div class="item-headline"><i class="fas fa-history"></i><span>最新文章</span></div><div class="aside-list"><div class="aside-list-item"><a class="thumbnail" href="/2022/03/28/Missing%20Semester/02-Shell%20Tools%20and%20Scripting/" title="02 - Shell Tools and Scripting"><img src="https://raw.githubusercontent.com/Warmchay/img/main/%E6%88%AA%E5%B1%8F2022-03-27%20%E4%B8%8B%E5%8D%8810.00.17.png" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="02 - Shell Tools and Scripting"/></a><div class="content"><a class="title" href="/2022/03/28/Missing%20Semester/02-Shell%20Tools%20and%20Scripting/" title="02 - Shell Tools and Scripting">02 - Shell Tools and Scripting</a><time datetime="2022-03-28T12:23:21.000Z" title="发表于 2022-03-28 20:23:21">2022-03-28</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2022/03/27/Advanced%20OS/02-Virtual%20Machine%20Monitor/" title="02 - Virtual Machine Monitor"><img src="https://raw.githubusercontent.com/Warmchay/img/main/%E6%88%AA%E5%B1%8F2022-03-27%20%E4%B8%8B%E5%8D%889.54.13.png" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="02 - Virtual Machine Monitor"/></a><div class="content"><a class="title" href="/2022/03/27/Advanced%20OS/02-Virtual%20Machine%20Monitor/" title="02 - Virtual Machine Monitor">02 - Virtual Machine Monitor</a><time datetime="2022-03-27T13:48:13.000Z" title="发表于 2022-03-27 21:48:13">2022-03-27</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2022/03/27/Missing%20Semester/01-Shell/" title="01 - Shell"><img src="https://raw.githubusercontent.com/Warmchay/img/main/%E6%88%AA%E5%B1%8F2022-03-27%20%E4%B8%8B%E5%8D%8810.00.17.png" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="01 - Shell"/></a><div class="content"><a class="title" href="/2022/03/27/Missing%20Semester/01-Shell/" title="01 - Shell">01 - Shell</a><time datetime="2022-03-27T13:41:10.000Z" title="发表于 2022-03-27 21:41:10">2022-03-27</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2022/03/26/Advanced%20OS/01-Overview/" title="01 - AOS Overview"><img src="https://raw.githubusercontent.com/Warmchay/img/main/%E6%88%AA%E5%B1%8F2022-03-27%20%E4%B8%8B%E5%8D%889.54.13.png" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="01 - AOS Overview"/></a><div class="content"><a class="title" href="/2022/03/26/Advanced%20OS/01-Overview/" title="01 - AOS Overview">01 - AOS Overview</a><time datetime="2022-03-26T14:23:12.000Z" title="发表于 2022-03-26 22:23:12">2022-03-26</time></div></div></div></div></div></div></main><footer id="footer" style="background-image: url('https://raw.githubusercontent.com/Warmchay/img/main/%E6%88%AA%E5%B1%8F2022-03-27%20%E4%B8%8B%E5%8D%8810.00.17.png')"><div id="footer-wrap"><div class="copyright">&copy;2022 By Zoris</div><div class="framework-info"><span>框架 </span><a target="_blank" rel="noopener" href="https://hexo.io">Hexo</a><span class="footer-separator">|</span><span>主题 </span><a target="_blank" rel="noopener" href="https://github.com/jerryc127/hexo-theme-butterfly">Butterfly</a></div></div></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="阅读模式"><i class="fas fa-book-open"></i></button><button id="translateLink" type="button" title="简繁转换">简</button><button id="darkmode" type="button" title="浅色和深色模式转换"><i class="fas fa-adjust"></i></button><button id="hide-aside-btn" type="button" title="单栏和双栏切换"><i class="fas fa-arrows-alt-h"></i></button></div><div id="rightside-config-show"><button id="rightside_config" type="button" title="设置"><i class="fas fa-cog fa-spin"></i></button><button class="close" id="mobile-toc-button" type="button" title="目录"><i class="fas fa-list-ul"></i></button><a id="to_comment" href="#post-comment" title="直达评论"><i class="fas fa-comments"></i></a><button id="go-up" type="button" title="回到顶部"><i class="fas fa-arrow-up"></i></button></div></div><div><script src="/js/utils.js"></script><script src="/js/main.js"></script><script src="/js/tw_cn.js"></script><script src="https://cdn.jsdelivr.net/npm/@fancyapps/ui/dist/fancybox.umd.js"></script><div class="js-pjax"><script>function loadDisqus () {
  var disqus_config = function () {
    this.page.url = 'http://example.com/2022/03/28/Missing%20Semester/02-Shell%20Tools%20and%20Scripting/'
    this.page.identifier = '2022/03/28/Missing Semester/02-Shell Tools and Scripting/'
    this.page.title = '02 - Shell Tools and Scripting'
  };

  window.disqusReset = () => {
    DISQUS.reset({
      reload: true,
      config: disqus_config
    })
  }

  if (window.DISQUS) disqusReset()
  else {
    (function() { 
      var d = document, s = d.createElement('script');
      s.src = 'https://.disqus.com/embed.js';
      s.setAttribute('data-timestamp', +new Date());
      (d.head || d.body).appendChild(s);
    })();
  }
}

if ('Valine# Valine' === 'Disqus' || !false) {
  if (false) btf.loadComment(document.getElementById('disqus_thread'), loadDisqus)
  else loadDisqus()
} else {
  function loadOtherComment () {
    loadDisqus()
  }
}
</script></div><div class="aplayer no-destroy" data-id="7319374102" data-server="netease" data-type="playlist" data-fixed="true" data-autoplay="true"> </div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/aplayer@1/dist/APlayer.min.css" media="print" onload="this.media='all'"><script src="https://cdn.jsdelivr.net/npm/aplayer@1/dist/APlayer.min.js"></script><script src="https://cdn.jsdelivr.net/gh/metowolf/MetingJS@1.2/dist/Meting.min.js"></script><script src="https://cdn.jsdelivr.net/npm/pjax/pjax.min.js"></script><script>let pjaxSelectors = ["title","#config-diff","#body-wrap","#rightside-config-hide","#rightside-config-show",".js-pjax"]

var pjax = new Pjax({
  elements: 'a:not([target="_blank"])',
  selectors: pjaxSelectors,
  cacheBust: false,
  analytics: false,
  scrollRestoration: false
})

document.addEventListener('pjax:send', function () {

  // removeEventListener scroll 
  window.tocScrollFn && window.removeEventListener('scroll', window.tocScrollFn)
  window.scrollCollect && window.removeEventListener('scroll', scrollCollect)

  typeof preloader === 'object' && preloader.initLoading()
  document.getElementById('rightside').style.cssText = "opacity: ''; transform: ''"
  
  if (window.aplayers) {
    for (let i = 0; i < window.aplayers.length; i++) {
      if (!window.aplayers[i].options.fixed) {
        window.aplayers[i].destroy()
      }
    }
  }

  typeof typed === 'object' && typed.destroy()

  //reset readmode
  const $bodyClassList = document.body.classList
  $bodyClassList.contains('read-mode') && $bodyClassList.remove('read-mode')

})

document.addEventListener('pjax:complete', function () {
  window.refreshFn()

  document.querySelectorAll('script[data-pjax]').forEach(item => {
    const newScript = document.createElement('script')
    const content = item.text || item.textContent || item.innerHTML || ""
    Array.from(item.attributes).forEach(attr => newScript.setAttribute(attr.name, attr.value))
    newScript.appendChild(document.createTextNode(content))
    item.parentNode.replaceChild(newScript, item)
  })

  GLOBAL_CONFIG.islazyload && window.lazyLoadInstance.update()

  typeof chatBtnFn === 'function' && chatBtnFn()
  typeof panguInit === 'function' && panguInit()

  // google analytics
  typeof gtag === 'function' && gtag('config', '', {'page_path': window.location.pathname});

  // baidu analytics
  typeof _hmt === 'object' && _hmt.push(['_trackPageview',window.location.pathname]);

  typeof loadMeting === 'function' && document.getElementsByClassName('aplayer').length && loadMeting()

  // prismjs
  typeof Prism === 'object' && Prism.highlightAll()

  typeof preloader === 'object' && preloader.endLoading()
})

document.addEventListener('pjax:error', (e) => {
  if (e.request.status === 404) {
    pjax.loadUrl('/404.html')
  }
})</script><script async data-pjax src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script></div></body></html>